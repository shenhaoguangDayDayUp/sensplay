{"version":3,"sources":["common/lazyload.js"],"names":["$","window","document","undefined","$window","fn","lazyload","options","update","counter","elements","each","$this","this","settings","skip_invisible","is","abovethetop","leftofbegin","belowthefold","rightoffold","failure_limit","trigger","$container","threshold","event","effect","container","data_attribute","appear","load","placeholder","failurelimit","effectspeed","effect_speed","extend","indexOf","bind","self","$self","loaded","attr","one","elements_left","length","call","original","hide","css","temp","grep","element","test","navigator","appVersion","originalEvent","persisted","ready","fold","innerHeight","height","scrollTop","offset","top","width","scrollLeft","left","inviewport","expr","below-the-fold","a","above-the-top","right-of-screen","left-of-screen","in-viewport","above-the-fold","right-of-fold","left-of-fold","jQuery"],"mappings":"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","file":"lazyload.js","sourcesContent":["/*\r\n * Lazy Load \r\n *\r\n */\r\n\r\n(function($, window, document, undefined) {\r\n    var $window = $(window);\r\n\r\n    $.fn.lazyload = function(options) {\r\n        var elements = this;\r\n        var $container;\r\n        var settings = {\r\n            threshold       : 0,\r\n            failure_limit   : 0,\r\n            event           : \"scroll\",\r\n            effect          : \"show\",\r\n            container       : window,\r\n            data_attribute  : \"original\",\r\n            skip_invisible  : true,\r\n            appear          : null,\r\n            load            : null,\r\n            placeholder     : \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC\"\r\n        };\r\n\r\n        function update() {\r\n            var counter = 0;\r\n\r\n            elements.each(function() {\r\n                var $this = $(this);\r\n                if (settings.skip_invisible && !$this.is(\":visible\")) {\r\n                    return;\r\n                }\r\n                if ($.abovethetop(this, settings) ||\r\n                    $.leftofbegin(this, settings)) {\r\n                        /* Nothing. */\r\n                } else if (!$.belowthefold(this, settings) &&\r\n                    !$.rightoffold(this, settings)) {\r\n                        $this.trigger(\"appear\");\r\n                        /* if we found an image we'll load, reset the counter */\r\n                        counter = 0;\r\n                } else {\r\n                    if (++counter > settings.failure_limit) {\r\n                        return false;\r\n                    }\r\n                }\r\n            });\r\n\r\n        }\r\n\r\n        if(options) {\r\n            /* Maintain BC for a couple of versions. */\r\n            if (undefined !== options.failurelimit) {\r\n                options.failure_limit = options.failurelimit;\r\n                delete options.failurelimit;\r\n            }\r\n            if (undefined !== options.effectspeed) {\r\n                options.effect_speed = options.effectspeed;\r\n                delete options.effectspeed;\r\n            }\r\n\r\n            $.extend(settings, options);\r\n        }\r\n\r\n        /* Cache container as jQuery as object. */\r\n        $container = (settings.container === undefined ||\r\n                      settings.container === window) ? $window : $(settings.container);\r\n\r\n        /* Fire one scroll event per scroll. Not one scroll event per image. */\r\n        if (0 === settings.event.indexOf(\"scroll\")) {\r\n            $container.bind(settings.event, function() {\r\n                return update();\r\n            });\r\n        }\r\n\r\n        this.each(function() {\r\n            var self = this;\r\n            var $self = $(self);\r\n\r\n            self.loaded = false;\r\n\r\n            /* If no src attribute given use data:uri. */\r\n            if ($self.attr(\"src\") === undefined || $self.attr(\"src\") === false) {\r\n                if ($self.is(\"img\")) {\r\n                    $self.attr(\"src\", settings.placeholder);\r\n                }\r\n            }\r\n\r\n            /* When appear is triggered load original image. */\r\n            $self.one(\"appear\", function() {\r\n                if (!this.loaded) {\r\n                    if (settings.appear) {\r\n                        var elements_left = elements.length;\r\n                        settings.appear.call(self, elements_left, settings);\r\n                    }\r\n                    $(\"<img />\")\r\n                        .bind(\"load\", function() {\r\n\r\n                            var original = $self.attr(\"data-\" + settings.data_attribute);\r\n                            $self.hide();\r\n                            if ($self.is(\"img\")) {\r\n                                $self.attr(\"src\", original);\r\n                            } else {\r\n                                $self.css(\"background-image\", \"url('\" + original + \"')\");\r\n                            }\r\n                            $self[settings.effect](settings.effect_speed);\r\n\r\n                            self.loaded = true;\r\n\r\n                            /* Remove image from array so it is not looped next time. */\r\n                            var temp = $.grep(elements, function(element) {\r\n                                return !element.loaded;\r\n                            });\r\n                            elements = $(temp);\r\n\r\n                            if (settings.load) {\r\n                                var elements_left = elements.length;\r\n                                settings.load.call(self, elements_left, settings);\r\n                            }\r\n                        })\r\n                        .attr(\"src\", $self.attr(\"data-\" + settings.data_attribute));\r\n                }\r\n            });\r\n\r\n            /* When wanted event is triggered load original image */\r\n            /* by triggering appear.                              */\r\n            if (0 !== settings.event.indexOf(\"scroll\")) {\r\n                $self.bind(settings.event, function() {\r\n                    if (!self.loaded) {\r\n                        $self.trigger(\"appear\");\r\n                    }\r\n                });\r\n            }\r\n        });\r\n\r\n        /* Check if something appears when window is resized. */\r\n        $window.bind(\"resize\", function() {\r\n            update();\r\n        });\r\n\r\n        /* With IOS5 force loading images when navigating with back button. ios5 强力加载 */\r\n        /* Non optimal workaround. */\r\n        if ((/(?:iphone|ipod|ipad).*os 5/gi).test(navigator.appVersion)) {\r\n            $window.bind(\"pageshow\", function(event) {\r\n                if (event.originalEvent && event.originalEvent.persisted) {\r\n                    elements.each(function() {\r\n                        $(this).trigger(\"appear\");\r\n                    });\r\n                }\r\n            });\r\n        }\r\n\r\n        /* Force initial check if images should appear. */\r\n        $(document).ready(function() {\r\n            update();\r\n        });\r\n\r\n        return this;\r\n    };\r\n\r\n    /* Convenience methods in jQuery namespace.           */\r\n    /* Use as  $.belowthefold(element, {threshold : 100, container : window}) */\r\n\r\n    $.belowthefold = function(element, settings) {\r\n        var fold;\r\n\r\n        if (settings.container === undefined || settings.container === window) {\r\n            fold = (window.innerHeight ? window.innerHeight : $window.height()) + $window.scrollTop();\r\n        } else {\r\n            fold = $(settings.container).offset().top + $(settings.container).height();\r\n        }\r\n\r\n        return fold <= $(element).offset().top - settings.threshold;\r\n    };\r\n\r\n    $.rightoffold = function(element, settings) {\r\n        var fold;\r\n\r\n        if (settings.container === undefined || settings.container === window) {\r\n            fold = $window.width() + $window.scrollLeft();\r\n        } else {\r\n            fold = $(settings.container).offset().left + $(settings.container).width();\r\n        }\r\n\r\n        return fold <= $(element).offset().left - settings.threshold;\r\n    };\r\n\r\n    $.abovethetop = function(element, settings) {\r\n        var fold;\r\n\r\n        if (settings.container === undefined || settings.container === window) {\r\n            fold = $window.scrollTop();\r\n        } else {\r\n            fold = $(settings.container).offset().top;\r\n        }\r\n\r\n        return fold >= $(element).offset().top + settings.threshold  + $(element).height();\r\n    };\r\n\r\n    $.leftofbegin = function(element, settings) {\r\n        var fold;\r\n\r\n        if (settings.container === undefined || settings.container === window) {\r\n            fold = $window.scrollLeft();\r\n        } else {\r\n            fold = $(settings.container).offset().left;\r\n        }\r\n\r\n        return fold >= $(element).offset().left + settings.threshold + $(element).width();\r\n    };\r\n\r\n    $.inviewport = function(element, settings) {\r\n         return !$.rightoffold(element, settings) && !$.leftofbegin(element, settings) &&\r\n                !$.belowthefold(element, settings) && !$.abovethetop(element, settings);\r\n     };\r\n\r\n    /* Custom selectors for your convenience.   */\r\n    /* Use as $(\"img:below-the-fold\").something() or */\r\n    /* $(\"img\").filter(\":below-the-fold\").something() which is faster */\r\n\r\n    $.extend($.expr[\":\"], {\r\n        \"below-the-fold\" : function(a) { return $.belowthefold(a, {threshold : 0}); },\r\n        \"above-the-top\"  : function(a) { return !$.belowthefold(a, {threshold : 0}); },\r\n        \"right-of-screen\": function(a) { return $.rightoffold(a, {threshold : 0}); },\r\n        \"left-of-screen\" : function(a) { return !$.rightoffold(a, {threshold : 0}); },\r\n        \"in-viewport\"    : function(a) { return $.inviewport(a, {threshold : 0}); },\r\n        /* Maintain BC for couple of versions. */\r\n        \"above-the-fold\" : function(a) { return !$.belowthefold(a, {threshold : 0}); },\r\n        \"right-of-fold\"  : function(a) { return $.rightoffold(a, {threshold : 0}); },\r\n        \"left-of-fold\"   : function(a) { return !$.rightoffold(a, {threshold : 0}); }\r\n    });\r\n\r\n})(jQuery, window, document);\r\n"]}